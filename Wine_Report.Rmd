---
title: "Wine Quality Report"
author: "Ben Aoki-Sherwood and Hugh Shanno"
date: "2023-02-14"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(car)
library(GGally)
library(patchwork)
library(broom)
```

```{r}
wine <- read.csv("https://www.math.carleton.edu/ckelling/data/wine_project.csv")
names(wine)
wine <- wine %>% mutate(index = row_number())
```

Check for covariance
```{r}
ggpairs(wine)
```

fit a basic model and examine VIF
```{r}
basic.wine.lm <- lm(quality ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + chlorides + free.sulfur.dioxide + total.sulfur.dioxide + density + pH + sulphates + alcohol + color, data = wine)
vif(basic.wine.lm)
```

Examine t and F tests for basic model
```{r}
anova(basic.wine.lm)
summary(basic.wine.lm)
```

remove outliers:
  -max sugar outlier has max leverage
  -total SO2 outlier has max std.resid

```{r}
aug_basic <- augment(basic.wine.lm, data = wine)
slice_max(wine, residual.sugar) # try removing sugar outlier: max leverage
wine_removed <- wine %>% filter(!(index %in% c(4381, 6345)))
```

```{r}
ggpairs(wine_removed)
```

```{r}
no.outliers.lm <- lm(quality ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + chlorides + free.sulfur.dioxide + total.sulfur.dioxide + density + pH + sulphates + alcohol + color, data = wine_removed)
vif(no.outliers.lm)
anova(no.outliers.lm)
summary(no.outliers.lm)
```

Fit next model iteration
```{r}
density.dropped.lm <- lm(quality ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + chlorides + free.sulfur.dioxide + total.sulfur.dioxide + pH + sulphates + alcohol + color, data = wine)
vif(density.dropped.lm)
anova(density.dropped.lm)
summary(density.dropped.lm)
#crp(density.dropped.lm)
```

```{r}
AIC(basic.wine.lm)
AIC(density.dropped.lm)
```

